# IMPORTANTE: Este archivo debe estar en la misma carpeta que index.html

# Desactivar inyección automática de scripts
<IfModule mod_pagespeed.c>
  ModPagespeed off
</IfModule>

# Prevenir transformaciones del contenido
SetEnv no-gzip 1
SetEnv dont-vary 1

<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Forzar HTTPS
  RewriteCond %{HTTPS} off
  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
  
  # Si el archivo/carpeta existe, servirlo
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]
  
  # Todas las demás solicitudes van a index.html (para Angular routing)
  RewriteRule ^ index.html [L]
</IfModule>

# Si mod_rewrite no está disponible, usar FallbackResource
<IfModule !mod_rewrite.c>
  FallbackResource /index.html
</IfModule>

# Headers de seguridad
<IfModule mod_headers.c>
  # Prevenir mixed content
  Header always set Content-Security-Policy "upgrade-insecure-requests"
  Header always set Strict-Transport-Security "max-age=31536000"
  
  # Seguridad básica
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
  
  # Prevenir que el servidor modifique el contenido
  Header set Cache-Control "no-transform"
</IfModule>

# Compresión
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Caché
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType text/html "access plus 0 seconds"
</IfModule>

# Tipos MIME correctos
<IfModule mod_mime.c>
  AddType text/css .css
  AddType application/javascript .js
  AddType application/json .json
</IfModule>

# Proteger archivos sensibles
<FilesMatch "^\.">
  Order allow,deny
  Deny from all
</FilesMatch>
